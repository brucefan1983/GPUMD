.. _kw_ensemble_standard:

:attr:`ensemble` (standard)
===========================

The :attr:`ensemble` keyword is used to set up an integration method (an "integrator").
The integrators described on this page provide conventional methods for controlling temperature and pressure during classical :term:`MD` simulations.
Background information pertaining to the different methods referred to on this page can be found :ref:`here <ensembles>`.


Syntax
------

:attr:`nve`
^^^^^^^^^^^
If the first parameter is :attr:`nve`, it means that the ensemble for the current run is NVE (micro-canonical).
There is no need to further specify any other parameters and the full command is simply::

    ensemble nve

:attr:`nvt_ber`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`nvt_ber`, it means that the ensemble for the current run is NVT (canonical) generated by using the :ref:`Berendsen method <berendsen_thermostat>`.
In this case, one needs to specify an initial target temperature :attr:`<T_1>`, a final target temperature :attr:`<T_2>`, and a parameter :attr:`<T_coup>`, which reflects the strength of the coupling between the system and the thermostat. The full command is::

    ensemble nvt_ber <T_1> <T_2> <T_coup>
 
The target temperature (not the instant system temperature) will vary linearly from :attr:`<T_1>` to :attr:`<T_2>` during a run.
The choice of :attr:`<T_coup>` is discussed :ref:`below <choice_of_parameters>`.

:attr:`nvt_nhc`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`nvt_nhc`, it is similar to the case of :attr:`nvt_ber`, but using the :ref:`Nose-Hoover chain method <nose_hoover_chain_thermostat>`.

:attr:`nvt_bdp`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`nvt_bdp`, it is similar to the case of :attr:`nvt_ber`, but using the :ref:`Bussi-Donadio-Parrinello method <bdp_thermostat>`.

:attr:`nvt_lan`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`nvt_lan`, it is similar to the case of :attr:`nvt_ber`, but using the :ref:`Langevin method <langevin_thermostat>` as proposed in [Bussi2007a]_.

:attr:`nvt_bao`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`nvt_bao`, it is similar to the case of :attr:`nvt_ber`, but using the Langevin method with BAOAB splitting [Leimkuhler2013]_.

:attr:`npt_ber`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`npt_ber`, it means that the ensemble for the current run is NPT (isothermalâ€“isobaric) generated by using the :ref:`Berendsen barostat <berendsen_barostat>`.
In this case, apart from the same parameters as in the case of :attr:`nvt_ber`, one needs to further specify some target pressure(s), the same number of estimated elastic moduli, and a pressure coupling constant :attr:`<p_coup>`.
The general format is::

  ensemble npt_ber <T_1> <T_2> <T_coup> {<pressure_control_parameters>}

with three different options for specifying :attr:`pressure_control_parameters`:

* *Condition 1*: Cell shape updates are isotropic

  .. code::

     <p_hydro> <C_hydro> <p_coup>
    
  This means you regard your system as isotropic and want to control the three box lengths uniformly according to the hydrostatic pressure :attr:`<p_hydro> = (p_xx + p_yy + p_zz)/3`.
  All directions should have periodic boundary conditions.
  Currently, we require the box to be orthogonal.

* *Condition 2*: Cell shape updates are orthorhombic

  .. code::

     <p_xx> <p_yy> <p_zz> <C_xx> <C_yy> <C_zz> <p_coup>

  In this case, the simulation box must be orthogonal.
  The three box lengths will be controlled independently according to their respective target pressures.
  Any direction can be either periodic or nonperiodic and pressure controlling will only be effective in periodic directions.

* *Condition 3*: Cell shape updates are triclinic

  .. code::

     <p_xx> <p_yy> <p_zz> <p_yz> <p_xz> <p_xy> <C_xx> <C_yy> <C_zz> <C_yz> <C_xz> <C_xy> <p_coup>

  The simulation box must be triclinic and all the directions must be periodic.
  All cell components will be controlled independently according to the 6 target pressure components.

  Elastic constants in literature may use a different nomenclature. The correspondence is as follows:

  | :attr:`C_xx=C_xxxx=C_11`, :attr:`C_yy=C_yyyy=C_22`, :attr:`C_zz=C_zzzz=C_33`,
  | :attr:`C_yz=C_yzyz=C_44`, :attr:`C_zx=C_zxzx=C_55`, :attr:`C_xy=C_xyxy=C_66`
  
  It is sufficient for the elastic constant tensor :attr:`C_ab` to be a (very rough) estimate as long as it is of the right magnitude.
  It is used to convert the coupling constant (or relaxation time, see :ref:`here <choice_of_parameters>`) of the barostat into suitable internal units.

:attr:`npt_scr`
^^^^^^^^^^^^^^^
If the first parameter is :attr:`npt_scr`, it is similar to the case of :attr:`npt_ber`, but using the :ref:`stochastic cell rescaling method <stochastic_cell_rescaling>`.
